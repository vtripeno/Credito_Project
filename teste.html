<html>
<head>
	<script type="text/javascript">
		
		function getAjax(url, success) {
		    var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
		    xhr.open('GET', url);
		    xhr.onreadystatechange = function() {
		        if (xhr.readyState>3 && xhr.status==200) success(xhr.responseText);
		    };
		    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
		    xhr.send();
		    alert(JSON.stringify(xhr.responseText));
		    return xhr;
		}

		function httpGet(theUrl) {
		    var xmlHttp = new XMLHttpRequest();
		    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
		    xmlHttp.send( null );
		    alert(JSON.stringify(xmlHttp.responseText));
		    var json = JSON.stringify(eval("({'cars':" + xmlHttp.responseText + "})"));
		    alert(json);
		    var obj = JSON.parse(json);
		    alert(obj.cars[1].name);
		    x = ""
			for (i in obj.cars) {
			    console.log(obj.cars[i].name);
			}
		    return obj;
		}

		function criarCombo() {
			var myDiv = document.getElementById("myDiv");

			//Create array of options to be added
			var array = httpGet('http://fipeapi.appspot.com/api/1/carros/marcas.json').cars;// ["Volvo","Saab","Mercades","Audi"];

			//Create and append select list
			var selectList = document.createElement("select");
			selectList.id = "mySelect";
			myDiv.appendChild(selectList);

			//Create and append the options
			for (var i = 0; i < array.length; i++) {
			    var option = document.createElement("option");
			    option.value = array[i].id;
			    option.text = array[i].name;
			    selectList.appendChild(option);
			}
		}
		
		// example request
		//getAjax('http://fipeapi.appspot.com/api/1/carros/veiculo/21/4828/2013-1.json', function(data){ console.log(data); });
	</script>

</head>

<body onload="criarCombo()">
	<button onclick="httpGet('http://fipeapi.appspot.com/api/1/carros/marcas.json');">CLICA</button>
	<button onclick="getAjax('http://fipeapi.appspot.com/api/1/carros/veiculo/21/4828/2013-1.json', function(data){ console.log(data); });">CLICA2</button>

	<br/>
	<div id="myDiv"></div>
</body>
</html>